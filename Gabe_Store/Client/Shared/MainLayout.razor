@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@inject ILocalStorageService LocalStorage
@inject AuthenticationStateProvider AuthStateProvider

<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />


<MudLayout>

    <MudAppBar Elevation="1">

        <MudText @onclick='() => GoTo("/")' Typo="Typo.h4">GayBE Store</MudText>

        <MudSpacer />

        <AuthorizeView>
            <Authorized>
                <MudButton Variant="Variant.Filled" Color="Color.Error" @onclick="Logout">Logout</MudButton>
            </Authorized>
            <NotAuthorized>
                <MudButton Variant="Variant.Filled" Color="Color.Secondary" @onclick='() => GoTo("login")'>Login</MudButton>
            </NotAuthorized>
        </AuthorizeView>


        <AuthorizeView>
            <Authorized>

            </Authorized>

            <NotAuthorized>
                <MudButton Variant="Variant.Filled" Color="Color.Secondary" @onclick='() => GoTo("register")' Style="margin-left: 20px">Register</MudButton>
            </NotAuthorized>
        </AuthorizeView>

    </MudAppBar>

    

    <MudMainContent >

        @Body

    </MudMainContent>

</MudLayout>




@code{

    void GoTo(string path)
    {
        NavigationManager.NavigateTo(path);
    }

    async Task Logout()
    {
        await LocalStorage.RemoveItemAsync("token");
        await AuthStateProvider.GetAuthenticationStateAsync();
        GoTo("/");
    }
    bool open = true;

    void ToggleDrawer()
    {
        open = !open;
    }
}